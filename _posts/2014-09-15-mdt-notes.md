---
layout: post
title: Notes from tinkering with MDT
---

## MDT 2013
### Pause Task Sequence Step
Add the following command to a standard `Run Command Line` step : `"%SCRIPTROOT%\LTISuspend.wsf"`

### Remove Windows Store Apps

~~~~ ps1
$AppList = "Microsoft.BingFinance",
           "Microsoft.BingFoodAndDrink",
           "Microsoft.BingHealthAndFitness",
           "Microsoft.BingMaps",
           "Microsoft.BingNews",
           "Microsoft.BingSports",
           "Microsoft.BingTravel",
           "Microsoft.BingWeather",
           "Microsoft.HelpAndTips",
           "Microsoft.Reader",
           "Microsoft.SkypeApp",
           "Microsoft.WindowsAlarms",
           "Microsoft.WindowsCalculator",
           "microsoft.windowscommunicationsapps",
           "Microsoft.WindowsReadingList",
           "Microsoft.WindowsScan",
           "Microsoft.WindowsSoundRecorder",
           "Microsoft.XboxLIVEGames",
           "Microsoft.ZuneMusic",
           "Microsoft.ZuneVideo"
 ForEach ($App in $AppList) {
   $AppxPackage = Get-AppxProvisionedPackage -online | Where {$_.DisplayName -eq $App}
   Remove-AppxProvisionedPackage -online -packagename ($AppxPackage.PackageName)
   Remove-AppxPackage ($AppxPackage.PackageName)
}
~~~~

### Use during the WinPE task sequence phase to get the serial number of the computer

{% gist abfceb2ec67bdb9c8dd7 %}

### Sample script to set a MOE version value in the registry

{% gist cb2d54a3bd0b0f0e3b1e %}

### References
* [Microsoft Catalogue](http://catalog.update.microsoft.com/v7/site/Thanks.aspx?id=140) for drivers etc...

## General
### Discover KMS Hosts in DNS
`nslookup -type=srv _vlmcs._tcp`

### References
* [Supporting Windows Mail 8.1 in your organization](http://blogs.technet.com/b/exchange/archive/2013/10/18/supporting-windows-mail-8-1-in-your-organization.aspx)
* [Windows 8: Automating the installation of .NET Framework 3.5 with MDT](http://blogs.technet.com/b/deploymentguys/archive/2012/11/13/windows-8-automating-the-installation-of-net-framework-3-5-with-mdt.aspx)
* [KMS Client Setup Keys](http://technet.microsoft.com/en-us/library/ff793421.aspx)

## Bootable Media
### Preparing USB Removable Media
~~~~ bat
diskpart
list disk
:: substitute n for the disk number of the USB drive
select disk n
clean
create part pri
format fs=fat32 quick
active
assign
~~~~

* [Deployment Research > Research - Creating a dual-boot WinPE 5.0 boot image (x86 and x64 support)](http://www.deploymentresearch.com/Research/tabid/62/EntryId/111/Creating-a-dual-boot-WinPE-5-0-boot-image-x86-and-x64-support.aspx)

## MDT 2012 Update 1
### Known Issues
#### Windows XP and MDT 2012 Update 1 asking for license key
Update the `unattend.ini` file with the product key from `product.ini` for the media.

* [MDT 2012 Update 1 - LTI Deploy Prompts for Product Key for Server 2008 R2 Standard](http://social.technet.microsoft.com/Forums/en-US/08d49431-f5ed-46e4-88f2-084dde8e4700/mdt-2012-update-1-lti-deploy-prompts-for-product-key-for-server-2008-r2-standard?forum=mdt)

#### Internet Explorer 10, Windows 7 and MDT 2012 Update 1

	> Windows could not parse or process unattend answer file (C:\Windows\Panther\unattend.xml) for pass [specialize]. A component or setting specified in the answer file does not exist.

Remove the line `<IEWelcomeMsg>false</IEWelcomeMsg>` from the `unattend.xml` file for the task sequence.

## Windows Setup
* Pressing `shift + F10` during the post WIM installation step will allow you to bring up a command prompt, allowing you to investigate errors in your `unattend.xml` file or review logs such as `setupact.log`

